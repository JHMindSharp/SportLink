{% extends 'base.html' %}

{% block title %}Profil de {{ user.first_name }} {{ user.last_name }} - SportLink{% endblock %}

{% block extra_head %}
    <link rel="stylesheet" href="{{ url_for('static', filename='css/profile.css') }}">
{% endblock %}

{% block extra_scripts %}
<script src="{{ url_for('static', filename='js/profile.js') }}"></script>
{% endblock %}

{% block content %}
<div class="profile-container">
    <!-- En-tête du profil avec photo de couverture et photo de profil -->
    <div class="profile-header">
        <!-- Photo de couverture -->
        <div class="cover-photo" 
             style="background-image: url('{{ url_for('static', filename='uploads/covers/' + (user.cover_image or 'default_cover.jpg')) }}');">
        </div>

        <!-- Photo de profil -->
        <div class="profile-photo" 
             style="background-image: url('{{ url_for('static', filename='uploads/profiles/' + (user.profile_image or 'default_profile.jpg')) }}');">
        </div>
    </div>

    <!-- Informations utilisateur -->
    <div class="profile-info">
        <h1>{{ user.first_name }} {{ user.last_name }}</h1>
        <p>{{ user.email }}</p>
    </div>

    <!-- Navigation du profil -->
    <nav class="profile-nav">
        <ul class="nav-left">
            <li><a href="{{ url_for('profile.profile', user_id=user.id) }}" class="active">Publications</a></li>
            <li><a href="{{ url_for('profile.list_friends') }}">Amis</a></li>
        </ul>
        <ul class="nav-right">
            <li><a href="{{ url_for('profile.photos', user_id=user.id) }}">Photos</a></li>
            <li><a href="{{ url_for('profile.settings') }}">Paramètres</a></li>
            {% if current_user == user %}
                <li><a href="{{ url_for('profile.edit_profile') }}">Modifier le profil</a></li>
            {% endif %}
        </ul>
    </nav>

    <!-- Contenu principal : publications et informations personnelles -->
    <div class="profile-main">
        <!-- Section des publications -->
        <div class="posts-section">
            {% if current_user == user %}
                <div class="create-post" onclick="window.location.href='{{ url_for('posts.create_post') }}'">
                    <p>Quoi de neuf, {{ user.first_name }} ?</p>
                </div>
            {% endif %}

            {% for post in posts %}
                <div class="post">
                    <div class="post-header">
                        <img src="{{ url_for('static', filename='uploads/profiles/' + (post.author.profile_image or 'default_profile.jpg')) }}" 
                             alt="{{ post.author.first_name }}">
                        <div>
                            <span class="author-name">{{ post.author.first_name }} {{ post.author.last_name }}</span>
                            <span class="post-date">{{ post.created_at.strftime('%d %B %Y à %H:%M') }}</span>
                        </div>
                    </div>
                    <div class="post-content">
                        {% if post.title %}
                            <h3>{{ post.title }}</h3>
                        {% endif %}
                        <p>{{ post.content }}</p>
                        {% if post.image %}
                            <img src="{{ url_for('static', filename='uploads/posts/' + post.image) }}" alt="Image de la publication">
                        {% endif %}
                        {% if post.video %}
                            <video controls>
                                <source src="{{ url_for('static', filename='uploads/posts/' + post.video) }}" type="video/mp4">
                                Votre navigateur ne supporte pas la lecture vidéo.
                            </video>
                        {% endif %}
                        {% if post.music %}
                            <audio controls>
                                <source src="{{ url_for('static', filename='uploads/posts/' + post.music) }}" type="audio/mpeg">
                                Votre navigateur ne supporte pas la lecture audio.
                            </audio>
                        {% endif %}
                    </div>
                </div>
            {% endfor %}
        </div>

        <!-- Section des informations personnelles -->
        <aside class="sidebar">
            <div class="info-card">
                <h3>Informations</h3>
                <ul>
                    <li><strong>Email :</strong> {% if current_user == user %}{{ user.email }}{% else %}Privé{% endif %}</li>
                    <li><strong>Prénom :</strong> {{ user.first_name }}</li>
                    <li><strong>Nom :</strong> {{ user.last_name }}</li>
                    <li><strong>Pays :</strong> {{ user.country or 'Non renseigné' }}</li>
                    <li><strong>Ville :</strong> {{ user.city or 'Non renseigné' }}</li>
                    <li><strong>Sexe :</strong> {{ user.sex or 'Non renseigné' }}</li>
                    <li><strong>Date de naissance :</strong> {% if user.birth_date %}{{ user.birth_date.strftime('%d/%m/%Y') }}{% else %}Non renseigné{% endif %}</li>
                </ul>
            </div>
        </aside>
    </div>
</div>
{% endblock %}
